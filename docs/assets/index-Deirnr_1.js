const H=(t,o)=>t.createdAt.getTime()-o.createdAt.getTime(),re=(t,o)=>o.committedDate.getTime()-t.committedDate.getTime(),P=document.getElementById("progress-bar"),b=document.getElementById("repo-view"),ie=document.getElementById("repo-header"),T=document.getElementById("repo-list"),ce=document.getElementById("repo-nav-hint"),C=document.getElementById("pr-view"),O=document.getElementById("open-pr-view"),M=document.getElementById("open-pr-header"),A=document.getElementById("open-pr-list"),x=document.getElementById("recent-pr-view"),ae=document.getElementById("recent-pr-header"),S=document.getElementById("recent-pr-list"),I=document.getElementById("settings-form"),B=document.getElementById("shortcuts-overlay"),z=document.getElementById("owner"),F=document.getElementById("team"),Q=document.getElementById("token"),le=document.getElementById("config-form"),de=(t,o,c)=>{const n=c?`"${c}"`:"null";return`{organization(login: "${t}") {team(slug: "${o}") {repositories(first: 100, after: ${n}) {totalCount pageInfo {endCursor hasNextPage} edges {permission node {name isArchived}}}}}}`},ge=`
  mainRef: ref(qualifiedName: "refs/heads/main") {
    ...RecentCommitHistory
  }
  masterRef: ref(qualifiedName: "refs/heads/master") {
    ...RecentCommitHistory
  }
`,he=`
  fragment RecentCommitHistory on Ref {
    target {
      ... on Commit {
        history(first: 25, since: "%s") {
          nodes {
            committedDate
            messageHeadline
            parents {
              totalCount
            }
            associatedPullRequests(first: 5) {
              nodes {
                createdAt
                number
                title
                url
                author { login }
                repository { name }
              }
            }
          }
        }
      }
    }
  }
`,fe="pullRequests(last: 15, states: OPEN) { nodes {title url createdAt baseRefName headRefOid isDraft number author { login } comments (first: 50) {nodes {createdAt author { login }}} reviews(first: 50) {nodes {state createdAt author { login }}} commits(last: 1) { nodes { commit { oid statusCheckRollup { state }}}} reviewDecision }}",me=(t,o,c,n="")=>{let s;t==="recent"?s=ge.replace("%s",n):s=fe;const i=c.map(a=>`${a.replace(/[^a-zA-Z0-9]/g,"")}:repository(owner: "${o}", name: "${a}") { name ${s} }`).join(" ");return t==="recent"?`
      ${he.replace("%s",n)}

      query ${t}PRs {
        ${i}
      }
    `:`query ${t}PRs { ${i} }`},y={fetchBatchQueries:async(t,o,c,n,s)=>{const i=Array.from({length:Math.ceil(n.length/4)},(a,g)=>n.slice(g*4,(g+1)*4));return Promise.all(i.map(async a=>{const g=await fetch("https://api.github.com/graphql",{method:"post",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({query:me(o,c,a,s)})});if(!g.ok)throw new Error(`GraphQL request failed: ${g.status} ${g.statusText}`);return g.json()}))},queryTeamRepos:async(t,o,c)=>{let n=!0,s=null;const i=[];for(;n;){const a=await fetch("https://api.github.com/graphql",{method:"post",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({query:de(o,c,s)})});if(!a.ok)throw new Error(`GraphQL request failed: ${a.status} ${a.statusText}`);const h=(await a.json()).data.organization.team.repositories;h.edges.forEach(f=>{f.permission==="ADMIN"&&f.node.isArchived===!1&&i.push(f.node.name)}),n=h.pageInfo.hasNextPage,s=h.pageInfo.endCursor,await new Promise(f=>setTimeout(f,1e3))}return i},filterTeamRepos:async(t,o,c,n)=>{const s=[],a=Array(20).fill(Promise.resolve()),g=async f=>{try{const l=await fetch(`https://api.github.com/repos/${o}/${f}/teams`,{headers:{Authorization:`Bearer ${t}`}});if(!l.ok)throw new Error(`REST request failed: ${l.status} ${l.statusText}`);const r=await l.json();for(const d of r)if(d.slug===c&&d.permission==="admin"){s.push(f);break}}catch(l){console.error(`Error fetching teams for repo ${f}:`,l)}},h=n.map((f,l)=>{const r=()=>g(f),d=a[l%20].then(r);return a[l%20]=d,d});return await Promise.all(h),s}},j=t=>{t.createdAt=new Date(t.createdAt),t.committedDate&&(t.committedDate=new Date(t.committedDate)),t.reviews?.nodes?.forEach(o=>{o.createdAt=new Date(o.createdAt)}),t.comments?.nodes?.forEach(o=>{o.createdAt=new Date(o.createdAt)})},_=async(t,o,c,n)=>{try{m({isFetchingRecentPRs:!0}),L();const s=c.filter(r=>!n.includes(r)),i=new Date(Date.now()-336*60*60*1e3).toISOString(),a=await y.fetchBatchQueries(t,"recent",o,s,i),g=[];a.forEach(r=>{Object.keys(r.data).forEach(u=>{const w=r.data[u],R=w.mainRef;R?.target?.history?.nodes?.length>0&&g.push(R);const v=w.masterRef;v?.target?.history?.nodes?.length>0&&g.push(v)})});const h=[];g.forEach(r=>r.target.history.nodes.forEach(d=>d.parents.totalCount>1?d.associatedPullRequests.nodes.forEach(u=>{u.committedDate=d.committedDate,h.push(u)}):null));const f=[...new Set(h.map(r=>r.url))].map(r=>h.find(d=>d.url===r));f.forEach(j);const l=f.sort(re);m({recentPRs:l})}catch(s){console.log("Failed to fetch recent PRs",s)}finally{$(),m({isFetchingRecentPRs:!1})}},p=async(t,o,c,n)=>{try{m({isFetchingOpenPRs:!0}),L();const s=c.filter(h=>!n.includes(h)),i=await y.fetchBatchQueries(t,"open",o,s),a=[];i.forEach(h=>{Object.keys(h.data).forEach(l=>{const r=h.data[l].name,d=h.data[l]?.pullRequests.nodes??[];d.length>0&&a.push(...d.map(u=>({...u,repository:{name:r}})))})}),a.forEach(j);const g=a.sort(H).filter(h=>!h.isDraft);m({PRs:g})}catch(s){console.log("Failed to fetch open PRs",s)}finally{$(),m({isFetchingOpenPRs:!1})}},ue=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z" /></svg>',D=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z" /></svg>',V=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M3 13h18v-2H3v2z" /></svg>',G=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 352 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z" /></svg>',U=()=>'<svg stroke="currentColor" fill="currentColor" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z" /></svg>',pe=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" /></svg>',Re=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon unreviewed-icon"><title>Unreviewed PR - Needs review</title><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z" /></svg>',we=(t,o)=>{const c=[];t.nodes.forEach(i=>{const a=i.state==="COMMENTED"?"COMMENTED":i.state;c.push({createdAt:i.createdAt,author:i.author.login,state:a})}),o.nodes.forEach(i=>{c.push({createdAt:i.createdAt,author:i.author.login,state:"COMMENTED"})});const n=[];let s=null;return c.sort(H).forEach(i=>{!s||i.author!==s.author||i.state!==s.state?(s&&n.push(s),s={...i,count:1}):s.count=(s.count||1)+1}),s&&n.push(s),n},ve=t=>{const o=Date.now()-t.getTime();return o<36e5?"last-hour":o<72e5?"last-two-hours":o<864e5?"last-day":o<6048e5?"last-week":"over-week-old"},Pe=(t,o)=>{const c=o.nodes.find(g=>g.commit.oid===t),n={SUCCESS:U(),PENDING:D(),FAILURE:G(),EXPECTED:D(),ERROR:pe()},s=c?.commit?.statusCheckRollup?.state||"ERROR",i=n[s]||V();return`<span class="${s.toLowerCase()}">${i}</span>`},$e=({count:t,author:o,createdAt:c,state:n})=>{const s=(t??1)>1?`(${t})`:"",i=`${o}${s}`,a=c.toLocaleString();let g=`${i} ${n.toLowerCase()} at ${a}`;return n==="APPROVED"?`<span class="event-group approved" title="${g}">${i}${U()}</span>`:n==="CHANGES_REQUESTED"?(g=`${i} requested changes at ${a}`,`<span class="event-group changes-requested" title="${g}">${i}${G()}</span>`):n==="COMMENTED"?(g=`${i} commented at ${a}`,`<span class="event-group commented" title="${g}">${i}${ue()}</span>`):n==="DISMISSED"?(g=`${i} dismissed at ${a}`,`<span class="event-group dismissed" title="${g}">${i}${V()}</span>`):""},ye=t=>{const o=Date.now()-t.getTime();if(o<0||isNaN(o))return"Invalid Date";const c=Math.round(o/6e4),n=Math.round(o/864e5),s=Math.round(n/30),i=Math.round(n/360);return c<1?"less than a minute ago":c<45?`${c} minute${c===1?"":"s"} ago`:c<90?"about 1 hour ago":n<1?`about ${Math.floor(c/60)} hour${Math.floor(c/60)===1?"":"s"} ago`:n<30?`${n} day${n===1?"":"s"} ago`:s<12?`about ${s} month${s===1?"":"s"} ago`:`about ${i} year${i===1?"":"s"} ago`},q=(t,o=!0,c=!1,n=0,s=!1)=>{const{number:i,title:a,url:g,repository:h}=t,l=t[o?"committedDate":"createdAt"],r=ye(l),d=`pr-time-${t.url}`,u=s?"selected":"";if(o)return`<li class="pr-item ${u}" data-index="${n}" data-url="${g}"><div class="pr-main-line"><span id="${d}" title="${l}">${r}</span> ${t.author.login}&nbsp;<a href="${g}" target="_blank" rel="noopener noreferrer">${h.name}#${i}</a>&nbsp;${a}</div></li>`;const{createdAt:w,reviews:R,comments:v,baseRefName:E,author:{login:J},headRefOid:W,commits:K}=t,N=we(R,v),X=Pe(W,K),Z=R.nodes.length===0?Re():"",Y=`<a href="${g}" target="_blank" rel="noopener noreferrer">${h.name}#${t.number}</a>`,ee=c?E:"",te=`<span id="${d}" title="${l}">${r}</span>`,oe=`<div class="pr-main-line ${ve(w)}">${te} ${Z} ${X} ${ee} ${J} ${Y} ${a}</div>`,se=N.length>0?`<div class="pr-event-lines">&nbsp;&nbsp;${N.map((ne,Te)=>$e({...ne})).join("")}</div>`:"";return`<li class="pr-item ${u}" data-index="${n}" data-url="${g}">${oe}${se}</li>`},Ee={config:{token:localStorage.getItem("PR_RADIATOR_TOKEN")||"",owner:localStorage.getItem("PR_RADIATOR_OWNER")||"",team:localStorage.getItem("PR_RADIATOR_TEAM")||"",repos:JSON.parse(localStorage.getItem("PR_RADIATOR_REPOS")||"[]"),ignoreRepos:JSON.parse(localStorage.getItem("PR_RADIATOR_IGNORE_REPOS")||"[]")},PRs:[],recentPRs:[],showDependabotPRs:!1,showNeedsReviewPRs:!1,showRecentPRs:!1,showRepoLinks:!1,selectedRepoIndex:-1,selectedPrIndex:-1,isFetchingOpenPRs:!1,isFetchingRecentPRs:!1};let e={...Ee};const L=()=>{P&&P.classList.add("active")},$=()=>{P&&(P.classList.add("fade-out"),setTimeout(()=>{P&&P.classList.remove("active","fade-out")},300))},m=t=>{e={...e,...t},k()},Ie=t=>e.config.ignoreRepos.includes(t),ke=t=>{const o=[...e.config.ignoreRepos],c=o.indexOf(t);c>-1?o.splice(c,1):o.push(t),m({config:{...e.config,ignoreRepos:o}})},be=t=>{t.preventDefault();const o=z.value,c=Q.value,n=F.value;localStorage.setItem("PR_RADIATOR_OWNER",o),localStorage.setItem("PR_RADIATOR_TOKEN",c),localStorage.setItem("PR_RADIATOR_TEAM",n),m({config:{...e.config,team:n,token:c,owner:o}}),e.config.token&&e.config.owner&&e.config.repos.length>0?p(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(s=>{console.error("Error fetching PRs after submit",s)}):e.config.token&&e.config.owner&&e.config.team&&e.config.repos.length===0&&(L(),k(),y.queryTeamRepos(c,o,n).then(s=>y.filterTeamRepos(c,o,n,s)).then(s=>{localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(s)),m({config:{...e.config,repos:s}}),k(),s.length>0?p(c,o,s,e.config.ignoreRepos).catch(i=>{console.error("Error fetching PRs after repos",i),$()}):$()}).catch(s=>{console.error("Error fetching repos after submit",s),$(),k()}))},k=()=>{const{config:{token:t,owner:o,team:c,repos:n},selectedRepoIndex:s,selectedPrIndex:i,showRepoLinks:a}=e;if(document.title="PR Radiator",!t||!o||!c){I.style.display="block",b.classList.add("hidden"),C.classList.add("hidden");return}if(I.style.display="none",n.length===0){b.classList.add("hidden"),M.innerHTML=`<div>Fetching ${c} team repositories...</div>`,A.innerHTML="",O.classList.remove("hidden");return}if(a){b.classList.remove("hidden"),C.classList.add("hidden");const h=((l,r)=>{const d=r!==null?`(${r})`:"";return`${l} ${d}`})("Repositories",n.length);ie.innerHTML=h;const f=n.map((l,r)=>`<li class="${`repo-item ${Ie(l)?"ignored":""} ${r===s?"selected":""}`}" data-index="${r}" data-repo="${l}"><a href="https://github.com/${o}/${l}" target="_blank" rel="noopener noreferrer">${l}</a></li>`).join("");T.innerHTML=f,ce.innerHTML="j/k to navigate · enter to open · i to toggle ignore",s>=0&&(T.focus(),setTimeout(()=>{const l=T.querySelector(".repo-item.selected");l&&l.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}else{b.classList.add("hidden"),C.classList.remove("hidden");const g=(h,f=null,l="")=>{const r=l?`<span class="pr-state">${l.toLowerCase()}</span>`:"",d=f!==null?`(${f} ${r})`:"";return`<div class="section-header">${h} ${d}</div>`};if(e.showRecentPRs){const h=e.recentPRs,f=h.length,l=e.isFetchingRecentPRs?`<span class="fetching-spinner">${D()}</span>`:f;ae.innerHTML=g("Pull requests",l,"MERGED"),S.innerHTML=h.map((r,d)=>q(r,!0,!1,d,d===i)).join(""),document.title=`(${f}) PR Radiator`,x.classList.remove("hidden"),O.classList.add("hidden"),i>=0&&(S.focus(),setTimeout(()=>{const r=S.querySelector(".pr-item.selected");r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}else{const h=e.PRs.filter(r=>e.showDependabotPRs||r.author.login!=="dependabot").filter(r=>!e.showNeedsReviewPRs||r.reviewDecision==="REVIEW_REQUIRED"||r.reviewDecision===null),f=h.length,l=e.isFetchingOpenPRs?`<span class="fetching-spinner">${D()}</span>`:f;M.innerHTML=g("Pull requests",l,"OPEN"),A.innerHTML=h.map((r,d)=>q(r,!1,!0,d,d===i)).join(""),document.title=`(${f}) PR Radiator`,O.classList.remove("hidden"),x.classList.add("hidden"),i>=0&&(A.focus(),setTimeout(()=>{const r=A.querySelector(".pr-item.selected");r&&r.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}}},Ae=(t,o)=>{let c=t,n;return n=setInterval(()=>c(),o),()=>clearInterval(n)},De=async()=>{const{config:{token:t,owner:o,team:c,repos:n,ignoreRepos:s}}=e;t&&o&&n.length>0&&await p(t,o,n,s),Ae(()=>{t&&o&&n.length>0&&p(t,o,n,s).catch(a=>{console.error("Error in fetchOpenPRs on interval",a)})},3e5),I.hasAttribute("data-initialized")||(z.value=o,F.value=c,Q.value=t,le.addEventListener("submit",be),I.setAttribute("data-initialized","true"));let i={key:null,timestamp:0};if(document.addEventListener("keydown",a=>{if(I.style.display==="block"||document.activeElement.tagName==="INPUT")return;const{showRepoLinks:g}=e,h=(l,r,d,u,w={})=>{let R=!0;switch(a.key){case"j":case"ArrowDown":if(l.length>0){const E=r<0?0:Math.min(l.length-1,r+1);m({[d]:E})}break;case"k":case"ArrowUp":if(l.length>0){const E=r<0?0:Math.max(0,r-1);m({[d]:E})}break;case"g":const v=Date.now();i.key==="g"&&v-i.timestamp<500?(l.length>0&&m({[d]:0}),i={key:null,timestamp:0}):i={key:"g",timestamp:v};break;case"G":l.length>0&&m({[d]:l.length-1});break;case"Enter":l.length>0&&r>=0&&u(l[r]);break;default:w[a.key]?w[a.key]():R=!1}return R};if(g&&h(e.config.repos,e.selectedRepoIndex,"selectedRepoIndex",r=>{const d=`https://github.com/${e.config.owner}/${r}`;window.open(d,"_blank","noopener,noreferrer")},{i:()=>{if(e.config.repos.length>0&&e.selectedRepoIndex>=0){const r=e.config.repos[e.selectedRepoIndex];ke(r)}}}))return;if(!g){const l=e.showRecentPRs?e.recentPRs:e.PRs.filter(d=>e.showDependabotPRs||d.author.login!=="dependabot").filter(d=>!e.showNeedsReviewPRs||d.reviewDecision==="REVIEW_REQUIRED"||d.reviewDecision===null);if(h(l,e.selectedPrIndex,"selectedPrIndex",d=>window.open(d.url,"_blank","noopener,noreferrer")))return}const f={o:()=>{m({showRecentPRs:!1,showRepoLinks:!1,selectedRepoIndex:-1,selectedPrIndex:-1}),e.config.token&&e.config.owner&&e.config.repos.length>0&&p(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error)},m:()=>{e.showRecentPRs&&!e.showRepoLinks?(m({showRecentPRs:!1,showRepoLinks:!1,selectedRepoIndex:-1,selectedPrIndex:-1}),e.config.token&&e.config.owner&&e.config.repos.length>0&&p(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error)):(m({showRecentPRs:!0,showRepoLinks:!1,selectedRepoIndex:-1,selectedPrIndex:-1}),e.config.token&&e.config.owner&&e.config.repos.length>0&&_(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error))},l:()=>{e.showRepoLinks?(localStorage.setItem("PR_RADIATOR_IGNORE_REPOS",JSON.stringify(e.config.ignoreRepos)),m({showRepoLinks:!1,showRecentPRs:!1,selectedRepoIndex:-1,selectedPrIndex:-1}),e.config.token&&e.config.owner&&e.config.repos.length>0&&p(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error)):m({showRepoLinks:!0,selectedRepoIndex:-1,selectedPrIndex:-1})},d:()=>m({showDependabotPRs:!e.showDependabotPRs}),n:()=>m({showNeedsReviewPRs:!e.showNeedsReviewPRs}),r:()=>{e.config.token&&e.config.owner&&e.config.repos.length>0&&(e.showRecentPRs?_(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error):e.showRepoLinks||p(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error)),m({selectedPrIndex:-1,selectedRepoIndex:-1})},"?":()=>{B.style.display=B.style.display==="none"?"block":"none"}};f[a.key]&&f[a.key]()}),t&&o&&c&&n.length===0)try{L();const a=await y.queryTeamRepos(t,o,c),g=await y.filterTeamRepos(t,o,c,a);localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(g)),m({config:{...e.config,repos:g}})}catch(a){console.error("Error in getTeamRepos",a),$()}document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&t&&o&&n.length>0&&!e.isFetchingOpenPRs&&p(t,o,n,s).catch(a=>{console.error("Error in fetchOpenPRs on tab focus",a)})}),k()};De();
