const q=(t,s)=>t.createdAt.getTime()-s.createdAt.getTime(),ne=(t,s)=>s.committedDate.getTime()-t.committedDate.getTime(),y=document.getElementById("progress-bar"),A=document.getElementById("repo-view"),re=document.getElementById("repo-header"),L=document.getElementById("repo-list"),ce=document.getElementById("repo-nav-hint"),O=document.getElementById("pr-view"),S=document.getElementById("open-pr-view"),N=document.getElementById("open-pr-header"),D=document.getElementById("open-pr-list"),x=document.getElementById("recent-pr-view"),ie=document.getElementById("recent-pr-header"),C=document.getElementById("recent-pr-list"),I=document.getElementById("settings-form"),B=document.getElementById("shortcuts-overlay"),H=document.getElementById("owner"),z=document.getElementById("team"),F=document.getElementById("token"),ae=document.getElementById("config-form"),le=(t,s,a)=>{const c=a?`"${a}"`:"null";return`{organization(login: "${t}") {team(slug: "${s}") {repositories(first: 100, after: ${c}) {totalCount pageInfo {endCursor hasNextPage} edges {permission node {name isArchived}}}}}}`},de=`
  mainRef: ref(qualifiedName: "refs/heads/main") {
    ...RecentCommitHistory
  }
  masterRef: ref(qualifiedName: "refs/heads/master") {
    ...RecentCommitHistory
  }
`,he=`
  fragment RecentCommitHistory on Ref {
    target {
      ... on Commit {
        history(first: 25, since: "%s") {
          nodes {
            committedDate
            messageHeadline
            parents {
              totalCount
            }
            associatedPullRequests(first: 5) {
              nodes {
                createdAt
                number
                title
                url
                author { login }
                repository { name }
              }
            }
          }
        }
      }
    }
  }
`,ge="pullRequests(last: 15, states: OPEN) { nodes {title url createdAt baseRefName headRefOid isDraft number author { login } comments (first: 50) {nodes {createdAt author { login }}} reviews(first: 50) {nodes {state createdAt author { login }}} commits(last: 1) { nodes { commit { oid statusCheckRollup { state }}}} reviewDecision }}",me=(t,s,a,c="")=>{let r;t==="recent"?r=de.replace("%s",c):r=ge;const i=a.map(d=>`${d.replace(/[^a-zA-Z0-9]/g,"")}:repository(owner: "${s}", name: "${d}") { name ${r} }`).join(" ");return t==="recent"?`
      ${he.replace("%s",c)}

      query ${t}PRs {
        ${i}
      }
    `:`query ${t}PRs { ${i} }`},P={fetchBatchQueries:async(t,s,a,c,r)=>{const i=Array.from({length:Math.ceil(c.length/4)},(d,h)=>c.slice(h*4,(h+1)*4));return Promise.all(i.map(async d=>{const h=await fetch("https://api.github.com/graphql",{method:"post",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({query:me(s,a,d,r)})});if(!h.ok)throw new Error(`GraphQL request failed: ${h.status} ${h.statusText}`);return h.json()}))},queryTeamRepos:async(t,s,a)=>{let c=!0,r=null;const i=[];for(;c;){const d=await fetch("https://api.github.com/graphql",{method:"post",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({query:le(s,a,r)})});if(!d.ok)throw new Error(`GraphQL request failed: ${d.status} ${d.statusText}`);const g=(await d.json()).data.organization.team.repositories;g.edges.forEach(m=>{m.permission==="ADMIN"&&m.node.isArchived===!1&&i.push(m.node.name)}),c=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor,await new Promise(m=>setTimeout(m,1e3))}return i},filterTeamRepos:async(t,s,a,c)=>{const r=[],d=Array(20).fill(Promise.resolve()),h=async m=>{try{const o=await fetch(`https://api.github.com/repos/${s}/${m}/teams`,{headers:{Authorization:`Bearer ${t}`}});if(!o.ok)throw new Error(`REST request failed: ${o.status} ${o.statusText}`);const n=await o.json();for(const l of n)if(l.slug===a&&l.permission==="admin"){r.push(m);break}}catch(o){console.error(`Error fetching teams for repo ${m}:`,o)}},g=c.map((m,o)=>{const n=()=>h(m),l=d[o%20].then(n);return d[o%20]=l,l});return await Promise.all(g),r}},Q=t=>{t.createdAt=new Date(t.createdAt),t.committedDate&&(t.committedDate=new Date(t.committedDate)),t.reviews?.nodes?.forEach(s=>{s.createdAt=new Date(s.createdAt)}),t.comments?.nodes?.forEach(s=>{s.createdAt=new Date(s.createdAt)})},fe=async(t,s,a,c)=>{try{f({isFetchingRecentPRs:!0}),b();const r=a.filter(n=>!c.includes(n)),i=new Date(Date.now()-336*60*60*1e3).toISOString(),d=await P.fetchBatchQueries(t,"recent",s,r,i),h=[];d.forEach(n=>{Object.keys(n.data).forEach(u=>{const v=n.data[u],R=v.mainRef;R?.target?.history?.nodes?.length>0&&h.push(R);const $=v.masterRef;$?.target?.history?.nodes?.length>0&&h.push($)})});const g=[];h.forEach(n=>n.target.history.nodes.forEach(l=>l.parents.totalCount>1?l.associatedPullRequests.nodes.forEach(u=>{u.committedDate=l.committedDate,g.push(u)}):null));const m=[...new Set(g.map(n=>n.url))].map(n=>g.find(l=>l.url===n));m.forEach(Q);const o=m.sort(ne);f({recentPRs:o})}catch(r){console.log("Failed to fetch recent PRs",r)}finally{p(),f({isFetchingRecentPRs:!1})}},w=async(t,s,a,c)=>{try{f({isFetchingOpenPRs:!0}),b();const r=a.filter(g=>!c.includes(g)),i=await P.fetchBatchQueries(t,"open",s,r),d=[];i.forEach(g=>{Object.keys(g.data).forEach(o=>{const n=g.data[o].name,l=g.data[o]?.pullRequests.nodes??[];l.length>0&&d.push(...l.map(u=>({...u,repository:{name:n}})))})}),d.forEach(Q);const h=d.sort(q).filter(g=>!g.isDraft);f({PRs:h})}catch(r){console.log("Failed to fetch open PRs",r)}finally{p(),f({isFetchingOpenPRs:!1})}},ue=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z" /></svg>',T=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z" /></svg>',j=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M3 13h18v-2H3v2z" /></svg>',V=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 352 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z" /></svg>',G=()=>'<svg stroke="currentColor" fill="currentColor" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z" /></svg>',pe=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" /></svg>',Re=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon unreviewed-icon"><title>Unreviewed PR - Needs review</title><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z" /></svg>',we=(t,s)=>{const a=[];t.nodes.forEach(i=>{const d=i.state==="COMMENTED"?"COMMENTED":i.state;a.push({createdAt:i.createdAt,author:i.author.login,state:d})}),s.nodes.forEach(i=>{a.push({createdAt:i.createdAt,author:i.author.login,state:"COMMENTED"})});const c=[];let r=null;return a.sort(q).forEach(i=>{!r||i.author!==r.author||i.state!==r.state?(r&&c.push(r),r={...i,count:1}):r.count=(r.count||1)+1}),r&&c.push(r),c},Pe=t=>{const s=Date.now()-t.getTime();return s<36e5?"last-hour":s<72e5?"last-two-hours":s<864e5?"last-day":s<6048e5?"last-week":"over-week-old"},ve=(t,s)=>{const a=s.nodes.find(h=>h.commit.oid===t),c={SUCCESS:G(),PENDING:T(),FAILURE:V(),EXPECTED:T(),ERROR:pe()},r=a?.commit?.statusCheckRollup?.state||"ERROR",i=c[r]||j();return`<span class="${r.toLowerCase()}">${i}</span>`},$e=({count:t,author:s,createdAt:a,state:c})=>{const r=(t??1)>1?`(${t})`:"",i=`${s}${r}`,d=a.toLocaleString();let h=`${i} ${c.toLowerCase()} at ${d}`;return c==="APPROVED"?`<span class="event-group approved" title="${h}">${i}${G()}</span>`:c==="CHANGES_REQUESTED"?(h=`${i} requested changes at ${d}`,`<span class="event-group changes-requested" title="${h}">${i}${V()}</span>`):c==="COMMENTED"?(h=`${i} commented at ${d}`,`<span class="event-group commented" title="${h}">${i}${ue()}</span>`):c==="DISMISSED"?(h=`${i} dismissed at ${d}`,`<span class="event-group dismissed" title="${h}">${i}${j()}</span>`):""},ye=t=>{const s=Date.now()-t.getTime();if(s<0||isNaN(s))return"Invalid Date";const a=Math.round(s/6e4),c=Math.round(s/864e5),r=Math.round(c/30),i=Math.round(c/360);return a<1?"less than a minute ago":a<45?`${a} minute${a===1?"":"s"} ago`:a<90?"about 1 hour ago":c<1?`about ${Math.floor(a/60)} hour${Math.floor(a/60)===1?"":"s"} ago`:c<30?`${c} day${c===1?"":"s"} ago`:r<12?`about ${r} month${r===1?"":"s"} ago`:`about ${i} year${i===1?"":"s"} ago`},_=(t,s=!0,a=!1,c=0,r=!1)=>{const{number:i,title:d,url:h,repository:g}=t,o=t[s?"committedDate":"createdAt"],n=ye(o),l=`pr-time-${t.url}`,u=r?"selected":"";if(s)return`<li class="pr-item ${u}" data-index="${c}" data-url="${h}"><div class="pr-main-line"><span id="${l}" title="${o}">${n}</span> ${t.author.login}&nbsp;<a href="${h}" target="_blank" rel="noopener noreferrer">${g.name}#${i}</a>&nbsp;${d}</div></li>`;const{createdAt:v,reviews:R,comments:$,baseRefName:E,author:{login:J},headRefOid:U,commits:W}=t,M=we(R,$),K=ve(U,W),X=R.nodes.length===0?Re():"",Z=`<a href="${h}" target="_blank" rel="noopener noreferrer">${g.name}#${t.number}</a>`,Y=a?E:"",ee=`<span id="${l}" title="${o}">${n}</span>`,te=`<div class="pr-main-line ${Pe(v)}">${ee} ${X} ${K} ${Y} ${J} ${Z} ${d}</div>`,se=M.length>0?`<div class="pr-event-lines">&nbsp;&nbsp;${M.map((oe,Le)=>$e({...oe})).join("")}</div>`:"";return`<li class="pr-item ${u}" data-index="${c}" data-url="${h}">${te}${se}</li>`},Ee={config:{token:localStorage.getItem("PR_RADIATOR_TOKEN")||"",owner:localStorage.getItem("PR_RADIATOR_OWNER")||"",team:localStorage.getItem("PR_RADIATOR_TEAM")||"",repos:JSON.parse(localStorage.getItem("PR_RADIATOR_REPOS")||"[]"),ignoreRepos:JSON.parse(localStorage.getItem("PR_RADIATOR_IGNORE_REPOS")||"[]")},PRs:[],recentPRs:[],showDependabotPRs:!1,showMasterPRs:!0,showNeedsReviewPRs:!1,showRecentPRs:!1,showRepoLinks:!1,selectedRepoIndex:-1,selectedPrIndex:-1,isFetchingOpenPRs:!1,isFetchingRecentPRs:!1};let e={...Ee};const b=()=>{y&&y.classList.add("active")},p=()=>{y&&(y.classList.add("fade-out"),setTimeout(()=>{y&&y.classList.remove("active","fade-out")},300))},f=t=>{e={...e,...t},k()},Ie=t=>e.config.ignoreRepos.includes(t),ke=t=>{const s=[...e.config.ignoreRepos],a=s.indexOf(t);a>-1?s.splice(a,1):s.push(t),f({config:{...e.config,ignoreRepos:s}})},be=t=>{t.preventDefault();const s=H.value,a=F.value,c=z.value;localStorage.setItem("PR_RADIATOR_OWNER",s),localStorage.setItem("PR_RADIATOR_TOKEN",a),localStorage.setItem("PR_RADIATOR_TEAM",c),f({config:{...e.config,team:c,token:a,owner:s}}),e.config.token&&e.config.owner&&e.config.repos.length>0?w(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(r=>{console.error("Error fetching PRs after submit",r)}):e.config.token&&e.config.owner&&e.config.team&&e.config.repos.length===0&&(b(),k(),P.queryTeamRepos(a,s,c).then(r=>P.filterTeamRepos(a,s,c,r)).then(r=>{localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(r)),f({config:{...e.config,repos:r}}),k(),r.length>0?w(a,s,r,e.config.ignoreRepos).catch(i=>{console.error("Error fetching PRs after repos",i),p()}):p()}).catch(r=>{console.error("Error fetching repos after submit",r),p(),k()}))},k=()=>{const{config:{token:t,owner:s,team:a,repos:c},selectedRepoIndex:r,selectedPrIndex:i,showRepoLinks:d}=e;if(document.title="PR Radiator",!t||!s||!a){I.style.display="block",A.classList.add("hidden"),O.classList.add("hidden");return}if(I.style.display="none",c.length===0){A.classList.add("hidden"),N.innerHTML=`<div>Fetching ${a} team repositories...</div>`,D.innerHTML="",S.classList.remove("hidden");return}if(d){A.classList.remove("hidden"),O.classList.add("hidden");const g=((o,n)=>{const l=n!==null?`(${n})`:"";return`${o} ${l}`})("Repositories",c.length);re.innerHTML=g;const m=c.map((o,n)=>`<li class="${`repo-item ${Ie(o)?"ignored":""} ${n===r?"selected":""}`}" data-index="${n}" data-repo="${o}"><a href="https://github.com/${s}/${o}" target="_blank" rel="noopener noreferrer">${o}</a></li>`).join("");L.innerHTML=m,ce.innerHTML="j/k to navigate · enter to open · i to toggle ignore",r>=0&&(L.focus(),setTimeout(()=>{const o=L.querySelector(".repo-item.selected");o&&o.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}else{A.classList.add("hidden"),O.classList.remove("hidden");const h=(g,m=null,o="")=>{const n=o?`<span class="pr-state">${o.toLowerCase()}</span>`:"",l=m!==null?`(${m} ${n})`:"";return`<div class="section-header">${g} ${l}</div>`};if(e.showRecentPRs){const g=e.recentPRs,m=g.length,o=e.isFetchingRecentPRs?`<span class="fetching-spinner">${T()}</span>`:m;ie.innerHTML=h("Pull requests",o,"MERGED"),C.innerHTML=g.map((n,l)=>_(n,!0,!1,l,l===i)).join(""),document.title=`(${m}) PR Radiator`,x.classList.remove("hidden"),S.classList.add("hidden"),i>=0&&(C.focus(),setTimeout(()=>{const n=C.querySelector(".pr-item.selected");n&&n.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}else{const g=e.PRs.filter(n=>e.showDependabotPRs||n.author.login!=="dependabot").filter(n=>e.showMasterPRs||n.baseRefName!=="master"&&n.baseRefName!=="main").filter(n=>!e.showNeedsReviewPRs||n.reviewDecision==="REVIEW_REQUIRED"||n.reviewDecision===null),m=g.length,o=e.isFetchingOpenPRs?`<span class="fetching-spinner">${T()}</span>`:m;N.innerHTML=h("Pull requests",o,"OPEN"),D.innerHTML=g.map((n,l)=>_(n,!1,e.showMasterPRs,l,l===i)).join(""),document.title=`(${m}) PR Radiator`,S.classList.remove("hidden"),x.classList.add("hidden"),i>=0&&(D.focus(),setTimeout(()=>{const n=D.querySelector(".pr-item.selected");n&&n.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}}},Ae=(t,s)=>{let a=t,c;return c=setInterval(()=>a(),s),()=>clearInterval(c)},De=async()=>{const{config:{token:t,owner:s,team:a,repos:c,ignoreRepos:r}}=e;t&&s&&c.length>0&&await w(t,s,c,r),Ae(()=>{t&&s&&c.length>0&&w(t,s,c,r).catch(d=>{console.error("Error in fetchOpenPRs on interval",d)})},3e5),I.hasAttribute("data-initialized")||(H.value=s,z.value=a,F.value=t,ae.addEventListener("submit",be),I.setAttribute("data-initialized","true"));let i={key:null,timestamp:0};if(document.addEventListener("keydown",d=>{if(I.style.display==="block"||document.activeElement.tagName==="INPUT")return;const{showRepoLinks:h}=e,g=(o,n,l,u,v={})=>{let R=!0;switch(d.key){case"j":case"ArrowDown":if(o.length>0){const E=n<0?0:Math.min(o.length-1,n+1);f({[l]:E})}break;case"k":case"ArrowUp":if(o.length>0){const E=n<0?0:Math.max(0,n-1);f({[l]:E})}break;case"g":const $=Date.now();i.key==="g"&&$-i.timestamp<500?(o.length>0&&f({[l]:0}),i={key:null,timestamp:0}):i={key:"g",timestamp:$};break;case"G":o.length>0&&f({[l]:o.length-1});break;case"Enter":o.length>0&&n>=0&&u(o[n]);break;default:v[d.key]?v[d.key]():R=!1}return R};if(h&&g(e.config.repos,e.selectedRepoIndex,"selectedRepoIndex",n=>{const l=`https://github.com/${e.config.owner}/${n}`;window.open(l,"_blank","noopener,noreferrer")},{i:()=>{if(e.config.repos.length>0&&e.selectedRepoIndex>=0){const n=e.config.repos[e.selectedRepoIndex];ke(n)}}}))return;if(!h){const o=e.showRecentPRs?e.recentPRs:e.PRs.filter(l=>e.showDependabotPRs||l.author.login!=="dependabot").filter(l=>e.showMasterPRs||l.baseRefName!=="master"&&l.baseRefName!=="main").filter(l=>!e.showNeedsReviewPRs||l.reviewDecision==="REVIEW_REQUIRED"||l.reviewDecision===null);if(g(o,e.selectedPrIndex,"selectedPrIndex",l=>window.open(l.url,"_blank","noopener,noreferrer")))return}const m={d:()=>f({showDependabotPRs:!e.showDependabotPRs}),m:()=>f({showMasterPRs:!e.showMasterPRs}),n:()=>f({showNeedsReviewPRs:!e.showNeedsReviewPRs}),a:()=>{const o=!e.showRecentPRs,n=o?e.recentPRs.length:e.PRs.length,l=e.selectedPrIndex>=n?Math.max(0,n-1):e.selectedPrIndex;f({showRecentPRs:o,selectedPrIndex:l}),o&&e.config.token&&e.config.owner&&e.config.repos.length>0&&fe(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error)},l:()=>{const o=!h;o?f({showRepoLinks:o,selectedRepoIndex:-1,selectedPrIndex:-1,showRecentPRs:!1}):(localStorage.setItem("PR_RADIATOR_IGNORE_REPOS",JSON.stringify(e.config.ignoreRepos)),e.config.token&&e.config.owner&&e.config.repos.length>0&&w(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error),f({showRepoLinks:o,selectedRepoIndex:-1,selectedPrIndex:-1}))},r:()=>{e.config.token&&e.config.owner&&e.config.repos.length>0&&w(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error),f({selectedPrIndex:-1})},"\\":()=>{f({config:{...e.config,repos:[]},PRs:[],recentPRs:[],selectedRepoIndex:-1,selectedPrIndex:-1}),b(),P.queryTeamRepos(e.config.token,e.config.owner,e.config.team).then(o=>P.filterTeamRepos(e.config.token,e.config.owner,e.config.team,o)).then(o=>{localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(o)),f({config:{...e.config,repos:o}}),o.length>0?w(e.config.token,e.config.owner,o,e.config.ignoreRepos).catch(n=>{console.error("Error fetching PRs after repos",n),p()}):p()}).catch(o=>{console.error("Error fetching repos after submit",o),p()})},"?":()=>{B.style.display=B.style.display==="none"?"block":"none"}};m[d.key]&&m[d.key]()}),t&&s&&a&&c.length===0)try{b();const d=await P.queryTeamRepos(t,s,a),h=await P.filterTeamRepos(t,s,a,d);localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(h)),f({config:{...e.config,repos:h}})}catch(d){console.error("Error in getTeamRepos",d),p()}document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&t&&s&&c.length>0&&!e.isFetchingOpenPRs&&w(t,s,c,r).catch(d=>{console.error("Error in fetchOpenPRs on tab focus",d)})}),k()};De();
