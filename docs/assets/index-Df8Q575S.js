const _=(t,s)=>t.createdAt.getTime()-s.createdAt.getTime(),ne=(t,s)=>s.committedDate.getTime()-t.committedDate.getTime(),P=document.getElementById("progress-bar"),b=document.getElementById("repo-view"),re=document.getElementById("repo-header"),x=document.getElementById("repo-list"),ce=document.getElementById("repo-nav-hint"),T=document.getElementById("pr-view"),L=document.getElementById("open-pr-view"),C=document.getElementById("open-pr-header"),A=document.getElementById("open-pr-list"),M=document.getElementById("recent-pr-view"),ie=document.getElementById("recent-pr-header"),O=document.getElementById("recent-pr-list"),$=document.getElementById("settings-form"),N=document.getElementById("shortcuts-overlay"),q=document.getElementById("owner"),H=document.getElementById("team"),z=document.getElementById("token"),ae=document.getElementById("config-form"),le=(t,s,a)=>{const r=a?`"${a}"`:"null";return`{organization(login: "${t}") {team(slug: "${s}") {repositories(first: 100, after: ${r}) {totalCount pageInfo {endCursor hasNextPage} edges {permission node {name isArchived}}}}}}`},de=`
  mainRef: ref(qualifiedName: "refs/heads/main") {
    ...RecentCommitHistory
  }
  masterRef: ref(qualifiedName: "refs/heads/master") {
    ...RecentCommitHistory
  }
`,he=`
  fragment RecentCommitHistory on Ref {
    target {
      ... on Commit {
        history(first: 25, since: "%s") {
          nodes {
            committedDate
            messageHeadline
            parents {
              totalCount
            }
            associatedPullRequests(first: 5) {
              nodes {
                createdAt
                number
                title
                url
                author { login }
                repository { name }
              }
            }
          }
        }
      }
    }
  }
`,ge="pullRequests(last: 15, states: OPEN) { nodes {title url createdAt baseRefName headRefOid isDraft number author { login } comments (first: 50) {nodes {createdAt author { login }}} reviews(first: 50) {nodes {state createdAt author { login }}} commits(last: 1) { nodes { commit { oid statusCheckRollup { state }}}} reviewDecision }}",fe=(t,s,a,r="")=>{let o;t==="recent"?o=de.replace("%s",r):o=ge;const n=a.map(h=>`${h.replace(/[^a-zA-Z0-9]/g,"")}:repository(owner: "${s}", name: "${h}") { name ${o} }`).join(" ");return t==="recent"?`
      ${he.replace("%s",r)}

      query ${t}PRs {
        ${n}
      }
    `:`query ${t}PRs { ${n} }`},w={fetchBatchQueries:async(t,s,a,r,o)=>{const n=Array.from({length:Math.ceil(r.length/4)},(h,g)=>r.slice(g*4,(g+1)*4));return Promise.all(n.map(async h=>{const g=await fetch("https://api.github.com/graphql",{method:"post",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({query:fe(s,a,h,o)})});if(!g.ok)throw new Error(`GraphQL request failed: ${g.status} ${g.statusText}`);return g.json()}))},queryTeamRepos:async(t,s,a)=>{let r=!0,o=null;const n=[];for(;r;){const h=await fetch("https://api.github.com/graphql",{method:"post",headers:{Authorization:`Bearer ${t}`},body:JSON.stringify({query:le(s,a,o)})});if(!h.ok)throw new Error(`GraphQL request failed: ${h.status} ${h.statusText}`);const c=(await h.json()).data.organization.team.repositories;c.edges.forEach(d=>{d.permission==="ADMIN"&&d.node.isArchived===!1&&n.push(d.node.name)}),r=c.pageInfo.hasNextPage,o=c.pageInfo.endCursor,await new Promise(d=>setTimeout(d,1e3))}return n},filterTeamRepos:async(t,s,a,r)=>{const o=[],h=Array(20).fill(Promise.resolve()),g=async d=>{try{const i=await fetch(`https://api.github.com/repos/${s}/${d}/teams`,{headers:{Authorization:`Bearer ${t}`}});if(!i.ok)throw new Error(`REST request failed: ${i.status} ${i.statusText}`);const l=await i.json();for(const f of l)if(f.slug===a&&f.permission==="admin"){o.push(d);break}}catch(i){console.error(`Error fetching teams for repo ${d}:`,i)}},c=r.map((d,i)=>{const l=()=>g(d),f=h[i%20].then(l);return h[i%20]=f,f});return await Promise.all(c),o}},F=t=>{t.createdAt=new Date(t.createdAt),t.committedDate&&(t.committedDate=new Date(t.committedDate)),t.reviews?.nodes?.forEach(s=>{s.createdAt=new Date(s.createdAt)}),t.comments?.nodes?.forEach(s=>{s.createdAt=new Date(s.createdAt)})},me=async(t,s,a,r)=>{try{m({isFetchingRecentPRs:!0}),y();const o=a.filter(l=>!r.includes(l)),n=new Date(Date.now()-336*60*60*1e3).toISOString(),h=await w.fetchBatchQueries(t,"recent",s,o,n),g=[];h.forEach(l=>{Object.keys(l.data).forEach(u=>{const E=l.data[u],v=E.mainRef;v?.target?.history?.nodes?.length>0&&g.push(v);const k=E.masterRef;k?.target?.history?.nodes?.length>0&&g.push(k)})});const c=[];g.forEach(l=>l.target.history.nodes.forEach(f=>f.parents.totalCount>1?f.associatedPullRequests.nodes.forEach(u=>{u.committedDate=f.committedDate,c.push(u)}):null));const d=[...new Set(c.map(l=>l.url))].map(l=>c.find(f=>f.url===l));d.forEach(F);const i=d.sort(ne);m({recentPRs:i})}catch(o){console.log("Failed to fetch recent PRs",o)}finally{p(),m({isFetchingRecentPRs:!1})}},R=async(t,s,a,r)=>{try{m({isFetchingOpenPRs:!0}),y();const o=a.filter(c=>!r.includes(c)),n=await w.fetchBatchQueries(t,"open",s,o),h=[];n.forEach(c=>{Object.keys(c.data).forEach(i=>{const l=c.data[i].name,f=c.data[i]?.pullRequests.nodes??[];f.length>0&&h.push(...f.map(u=>({...u,repository:{name:l}})))})}),h.forEach(F);const g=h.sort(_).filter(c=>!c.isDraft);m({PRs:g})}catch(o){console.log("Failed to fetch open PRs",o)}finally{p(),m({isFetchingOpenPRs:!1})}},ue=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32zM128 272c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32zm128 0c-17.7 0-32-14.3-32-32s14.3-32 32-32 32 14.3 32 32-14.3 32-32 32z" /></svg>',D=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M360 0H24C10.745 0 0 10.745 0 24v16c0 13.255 10.745 24 24 24 0 90.965 51.016 167.734 120.842 192C75.016 280.266 24 357.035 24 448c-13.255 0-24 10.745-24 24v16c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24v-16c0-13.255-10.745-24-24-24 0-90.965-51.016-167.734-120.842-192C308.984 231.734 360 154.965 360 64c13.255 0 24-10.745 24-24V24c0-13.255-10.745-24-24-24zm-75.078 384H99.08c17.059-46.797 52.096-80 92.92-80 40.821 0 75.862 33.196 92.922 80zm.019-256H99.078C91.988 108.548 88 86.748 88 64h208c0 22.805-3.987 44.587-11.059 64z" /></svg>',j=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M3 13h18v-2H3v2z" /></svg>',Q=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 352 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z" /></svg>',V=()=>'<svg stroke="currentColor" fill="currentColor" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z" /></svg>',pe=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" /></svg>',Re=()=>'<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" class="event-icon unreviewed-icon"><title>Unreviewed PR - Needs review</title><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z" /></svg>',we=(t,s)=>{const a=[];t.nodes.forEach(n=>{const h=n.state==="COMMENTED"?"COMMENTED":n.state;a.push({createdAt:n.createdAt,author:n.author.login,state:h})}),s.nodes.forEach(n=>{a.push({createdAt:n.createdAt,author:n.author.login,state:"COMMENTED"})});const r=[];let o=null;return a.sort(_).forEach(n=>{!o||n.author!==o.author||n.state!==o.state?(o&&r.push(o),o={...n,count:1}):o.count=(o.count||1)+1}),o&&r.push(o),r},Pe=t=>{const s=Date.now()-t.getTime();return s<36e5?"last-hour":s<72e5?"last-two-hours":s<864e5?"last-day":s<6048e5?"last-week":"over-week-old"},ve=(t,s)=>{const a=s.nodes.find(g=>g.commit.oid===t),r={SUCCESS:V(),PENDING:D(),FAILURE:Q(),EXPECTED:D(),ERROR:pe()},o=a?.commit?.statusCheckRollup?.state||"ERROR",n=r[o]||j();return`<span class="${o.toLowerCase()}">${n}</span>`},$e=({count:t,author:s,createdAt:a,state:r})=>{const o=(t??1)>1?`(${t})`:"",n=`${s}${o}`,h=a.toLocaleString();let g=`${n} ${r.toLowerCase()} at ${h}`;return r==="APPROVED"?`<span class="event-group approved" title="${g}">${n}${V()}</span>`:r==="CHANGES_REQUESTED"?(g=`${n} requested changes at ${h}`,`<span class="event-group changes-requested" title="${g}">${n}${Q()}</span>`):r==="COMMENTED"?(g=`${n} commented at ${h}`,`<span class="event-group commented" title="${g}">${n}${ue()}</span>`):r==="DISMISSED"?(g=`${n} dismissed at ${h}`,`<span class="event-group dismissed" title="${g}">${n}${j()}</span>`):""},Ie=t=>{const s=Date.now()-t.getTime();if(s<0||isNaN(s))return"Invalid Date";const a=Math.round(s/6e4),r=Math.round(s/864e5),o=Math.round(r/30),n=Math.round(r/360);return a<1?"less than a minute ago":a<45?`${a} minute${a===1?"":"s"} ago`:a<90?"about 1 hour ago":r<1?`about ${Math.floor(a/60)} hour${Math.floor(a/60)===1?"":"s"} ago`:r<30?`${r} day${r===1?"":"s"} ago`:o<12?`about ${o} month${o===1?"":"s"} ago`:`about ${n} year${n===1?"":"s"} ago`},B=(t,s=!0,a=!1,r=0,o=!1)=>{const{number:n,title:h,url:g,repository:c}=t,i=t[s?"committedDate":"createdAt"],l=Ie(i),f=`pr-time-${t.url}`,u=o?"selected":"";if(s)return`<li class="pr-item ${u}" data-index="${r}" data-url="${g}"><div class="pr-main-line"><span id="${f}" title="${i}">${l}</span> ${t.author.login}&nbsp;<a href="${g}" target="_blank" rel="noopener noreferrer">${c.name}/pull/${n}</a>&nbsp;${h}</div></li>`;const{createdAt:E,reviews:v,comments:k,baseRefName:U,author:{login:J},headRefOid:G,commits:W}=t,S=we(v,k),K=ve(G,W),X=v.nodes.length===0?Re():"",Z=`<a href="${g}" target="_blank" rel="noopener noreferrer">${c.name}#${t.number}</a>`,Y=a?U:"",ee=`<span id="${f}" title="${i}">${l}</span>`,te=`<div class="pr-main-line ${Pe(E)}">${ee} ${X} ${K} ${Y} ${J} ${Z} ${h}</div>`,se=S.length>0?`<div class="pr-event-lines">&nbsp;&nbsp;${S.map((oe,Te)=>$e({...oe})).join("")}</div>`:"";return`<li class="pr-item ${u}" data-index="${r}" data-url="${g}">${te}${se}</li>`},ye={config:{token:localStorage.getItem("PR_RADIATOR_TOKEN")||"",owner:localStorage.getItem("PR_RADIATOR_OWNER")||"",team:localStorage.getItem("PR_RADIATOR_TEAM")||"",repos:JSON.parse(localStorage.getItem("PR_RADIATOR_REPOS")||"[]"),ignoreRepos:JSON.parse(localStorage.getItem("PR_RADIATOR_IGNORE_REPOS")||"[]")},PRs:[],recentPRs:[],showDependabotPRs:!1,showMasterPRs:!0,showNeedsReviewPRs:!1,showRecentPRs:!1,showRepoLinks:!1,selectedRepoIndex:-1,selectedPrIndex:-1,isFetchingOpenPRs:!1,isFetchingRecentPRs:!1};let e={...ye};const y=()=>{P&&P.classList.add("active")},p=()=>{P&&(P.classList.add("fade-out"),setTimeout(()=>{P&&P.classList.remove("active","fade-out")},300))},m=t=>{e={...e,...t},I()},Ee=t=>e.config.ignoreRepos.includes(t),ke=t=>{const s=[...e.config.ignoreRepos],a=s.indexOf(t);a>-1?s.splice(a,1):s.push(t),m({config:{...e.config,ignoreRepos:s}})},be=t=>{t.preventDefault();const s=q.value,a=z.value,r=H.value;localStorage.setItem("PR_RADIATOR_OWNER",s),localStorage.setItem("PR_RADIATOR_TOKEN",a),localStorage.setItem("PR_RADIATOR_TEAM",r),m({config:{...e.config,team:r,token:a,owner:s}}),e.config.token&&e.config.owner&&e.config.repos.length>0?R(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(o=>{console.error("Error fetching PRs after submit",o)}):e.config.token&&e.config.owner&&e.config.team&&e.config.repos.length===0&&(y(),I(),w.queryTeamRepos(a,s,r).then(o=>w.filterTeamRepos(a,s,r,o)).then(o=>{localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(o)),m({config:{...e.config,repos:o}}),I(),o.length>0?R(a,s,o,e.config.ignoreRepos).catch(n=>{console.error("Error fetching PRs after repos",n),p()}):p()}).catch(o=>{console.error("Error fetching repos after submit",o),p(),I()}))},I=()=>{const{config:{token:t,owner:s,team:a,repos:r},selectedRepoIndex:o,selectedPrIndex:n,showRepoLinks:h}=e;if(document.title="PR Radiator",!t||!s||!a){$.style.display="block",b.classList.add("hidden"),T.classList.add("hidden");return}if($.style.display="none",r.length===0){b.classList.add("hidden"),C.innerHTML=`<div>Fetching ${a} team repositories...</div>`,A.innerHTML="",L.classList.remove("hidden");return}if(h){b.classList.remove("hidden"),T.classList.add("hidden");const c=((i,l)=>{const f=l!==null?`(${l})`:"";return`${i} ${f}`})("Repositories",r.length);re.innerHTML=c;const d=r.map((i,l)=>`<li class="${`repo-item ${Ee(i)?"ignored":""} ${l===o?"selected":""}`}" data-index="${l}" data-repo="${i}"><a href="https://github.com/${s}/${i}" target="_blank" rel="noopener noreferrer">${i}</a></li>`).join("");x.innerHTML=d,ce.innerHTML="j/k to navigate · enter to open · i to toggle ignore",o>=0&&(x.focus(),setTimeout(()=>{const i=x.querySelector(".repo-item.selected");i&&i.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}else{b.classList.add("hidden"),T.classList.remove("hidden");const g=(c,d=null,i="")=>{const l=i?`<span class="pr-state">${i.toLowerCase()}</span>`:"",f=d!==null?`(${d} ${l})`:"";return`<div class="section-header">${c} ${f}</div>`};if(e.showRecentPRs){const c=e.recentPRs,d=c.length,i=e.isFetchingRecentPRs?`<span class="fetching-spinner">${D()}</span>`:d;ie.innerHTML=g("Pull requests",i,"MERGED"),O.innerHTML=c.map((l,f)=>B(l,!0,!1,f,f===n)).join(""),document.title=`(${d}) PR Radiator`,M.classList.remove("hidden"),L.classList.add("hidden"),n>=0&&(O.focus(),setTimeout(()=>{const l=O.querySelector(".pr-item.selected");l&&l.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}else{const c=e.PRs.filter(l=>e.showDependabotPRs||l.author.login!=="dependabot").filter(l=>e.showMasterPRs||l.baseRefName!=="master"&&l.baseRefName!=="main").filter(l=>!e.showNeedsReviewPRs||l.reviewDecision==="REVIEW_REQUIRED"||l.reviewDecision===null),d=c.length,i=e.isFetchingOpenPRs?`<span class="fetching-spinner">${D()}</span>`:d;C.innerHTML=g("Pull requests",i,"OPEN"),A.innerHTML=c.map((l,f)=>B(l,!1,e.showMasterPRs,f,f===n)).join(""),document.title=`(${d}) PR Radiator`,L.classList.remove("hidden"),M.classList.add("hidden"),n>=0&&(A.focus(),setTimeout(()=>{const l=A.querySelector(".pr-item.selected");l&&l.scrollIntoView({behavior:"smooth",block:"nearest"})},0))}}},Ae=(t,s)=>{let a=t,r;return r=setInterval(()=>a(),s),()=>clearInterval(r)},De=async()=>{const{config:{token:t,owner:s,team:a,repos:r,ignoreRepos:o}}=e;if(t&&s&&r.length>0&&await R(t,s,r,o),Ae(()=>{t&&s&&r.length>0&&R(t,s,r,o).catch(n=>{console.error("Error in fetchOpenPRs on interval",n)})},3e5),$.hasAttribute("data-initialized")||(q.value=s,H.value=a,z.value=t,ae.addEventListener("submit",be),$.setAttribute("data-initialized","true")),document.addEventListener("keydown",n=>{if($.style.display==="block"||document.activeElement.tagName==="INPUT")return;const{showRepoLinks:h}=e;if(h){let c=!0;switch(n.key){case"j":case"ArrowDown":if(e.config.repos.length>0){const d=e.selectedRepoIndex<0?0:Math.min(e.config.repos.length-1,e.selectedRepoIndex+1);m({selectedRepoIndex:d})}break;case"k":case"ArrowUp":if(e.config.repos.length>0){const d=e.selectedRepoIndex<0?0:Math.max(0,e.selectedRepoIndex-1);m({selectedRepoIndex:d})}break;case"Enter":if(e.config.repos.length>0&&e.selectedRepoIndex>=0){const d=e.config.repos[e.selectedRepoIndex],i=`https://github.com/${e.config.owner}/${d}`;window.open(i,"_blank","noopener,noreferrer")}break;case"i":if(e.config.repos.length>0&&e.selectedRepoIndex>=0){const d=e.config.repos[e.selectedRepoIndex];ke(d)}break;default:c=!1}if(c)return}if(!h){const c=e.showRecentPRs?e.recentPRs:e.PRs.filter(i=>e.showDependabotPRs||i.author.login!=="dependabot").filter(i=>e.showMasterPRs||i.baseRefName!=="master"&&i.baseRefName!=="main").filter(i=>!e.showNeedsReviewPRs||i.reviewDecision==="REVIEW_REQUIRED"||i.reviewDecision===null);let d=!0;switch(n.key){case"j":case"ArrowDown":if(c.length>0){const i=e.selectedPrIndex<0?0:Math.min(c.length-1,e.selectedPrIndex+1);m({selectedPrIndex:i})}break;case"k":case"ArrowUp":if(c.length>0){const i=e.selectedPrIndex<0?0:Math.max(0,e.selectedPrIndex-1);m({selectedPrIndex:i})}break;case"Enter":if(c.length>0&&e.selectedPrIndex>=0){const i=c[e.selectedPrIndex];window.open(i.url,"_blank","noopener,noreferrer")}break;default:d=!1}if(d)return}const g={d:()=>m({showDependabotPRs:!e.showDependabotPRs}),m:()=>m({showMasterPRs:!e.showMasterPRs}),n:()=>m({showNeedsReviewPRs:!e.showNeedsReviewPRs}),a:()=>{const c=!e.showRecentPRs,d=c?e.recentPRs.length:e.PRs.length,i=e.selectedPrIndex>=d?Math.max(0,d-1):e.selectedPrIndex;m({showRecentPRs:c,selectedPrIndex:i}),c&&e.config.token&&e.config.owner&&e.config.repos.length>0&&me(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error)},l:()=>{const c=!h;c?m({showRepoLinks:c,selectedRepoIndex:-1,selectedPrIndex:-1,showRecentPRs:!1}):(localStorage.setItem("PR_RADIATOR_IGNORE_REPOS",JSON.stringify(e.config.ignoreRepos)),e.config.token&&e.config.owner&&e.config.repos.length>0&&R(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error),m({showRepoLinks:c,selectedRepoIndex:-1,selectedPrIndex:-1}))},r:()=>{e.config.token&&e.config.owner&&e.config.repos.length>0&&R(e.config.token,e.config.owner,e.config.repos,e.config.ignoreRepos).catch(console.error),m({selectedPrIndex:-1})},"\\":()=>{m({config:{...e.config,repos:[]},PRs:[],recentPRs:[],selectedRepoIndex:-1,selectedPrIndex:-1}),y(),w.queryTeamRepos(e.config.token,e.config.owner,e.config.team).then(c=>w.filterTeamRepos(e.config.token,e.config.owner,e.config.team,c)).then(c=>{localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(c)),m({config:{...e.config,repos:c}}),c.length>0?R(e.config.token,e.config.owner,c,e.config.ignoreRepos).catch(d=>{console.error("Error fetching PRs after repos",d),p()}):p()}).catch(c=>{console.error("Error fetching repos after submit",c),p()})},"?":()=>{N.style.display=N.style.display==="none"?"block":"none"}};g[n.key]&&g[n.key]()}),t&&s&&a&&r.length===0)try{y();const n=await w.queryTeamRepos(t,s,a),h=await w.filterTeamRepos(t,s,a,n);localStorage.setItem("PR_RADIATOR_REPOS",JSON.stringify(h)),m({config:{...e.config,repos:h}})}catch(n){console.error("Error in getTeamRepos",n),p()}document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&t&&s&&r.length>0&&!e.isFetchingOpenPRs&&R(t,s,r,o).catch(n=>{console.error("Error in fetchOpenPRs on tab focus",n)})}),I()};De();
